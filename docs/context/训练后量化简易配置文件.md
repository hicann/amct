# 训练后量化简易配置文件<a name="ZH-CN_TOPIC_0000002548668511"></a>

calibration\_config\_pytorch.proto文件参数说明如[表1](#zh-cn_topic_0240188735_table1225503375617)所示，该文件所在目录为：_AMCT安装目录_/amct\_pytorch/proto/calibration\_config\_pytorch.proto。

**表 1**  calibration\_config\_pytorch.proto参数说明

<a name="zh-cn_topic_0240188735_table1225503375617"></a>
<table><thead align="left"><tr id="zh-cn_topic_0240188735_row11255153315614"><th class="cellrowborder" valign="top" width="11.148885111488852%" id="mcps1.2.6.1.1"><p id="zh-cn_topic_0240188735_p6255193315616"><a name="zh-cn_topic_0240188735_p6255193315616"></a><a name="zh-cn_topic_0240188735_p6255193315616"></a>消息</p>
</th>
<th class="cellrowborder" valign="top" width="6.52934706529347%" id="mcps1.2.6.1.2"><p id="p194851125105014"><a name="p194851125105014"></a><a name="p194851125105014"></a>是否必填</p>
</th>
<th class="cellrowborder" valign="top" width="11.188881111888811%" id="mcps1.2.6.1.3"><p id="p466892519514"><a name="p466892519514"></a><a name="p466892519514"></a>类型</p>
</th>
<th class="cellrowborder" valign="top" width="12.84871512848715%" id="mcps1.2.6.1.4"><p id="zh-cn_topic_0240188735_p499481531910"><a name="zh-cn_topic_0240188735_p499481531910"></a><a name="zh-cn_topic_0240188735_p499481531910"></a>字段</p>
</th>
<th class="cellrowborder" valign="top" width="58.284171582841715%" id="mcps1.2.6.1.5"><p id="zh-cn_topic_0240188735_p122551335563"><a name="zh-cn_topic_0240188735_p122551335563"></a><a name="zh-cn_topic_0240188735_p122551335563"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0240188735_row122551133185610"><td class="cellrowborder" rowspan="11" valign="top" width="11.148885111488852%" headers="mcps1.2.6.1.1 "><p id="zh-cn_topic_0240188735_p1925513338569"><a name="zh-cn_topic_0240188735_p1925513338569"></a><a name="zh-cn_topic_0240188735_p1925513338569"></a>AMCTConfig</p>
</td>
<td class="cellrowborder" valign="top" width="6.52934706529347%" headers="mcps1.2.6.1.2 "><p id="p1485162505012"><a name="p1485162505012"></a><a name="p1485162505012"></a>-</p>
</td>
<td class="cellrowborder" valign="top" width="11.188881111888811%" headers="mcps1.2.6.1.3 "><p id="p1617031410516"><a name="p1617031410516"></a><a name="p1617031410516"></a>-</p>
</td>
<td class="cellrowborder" valign="top" width="12.84871512848715%" headers="mcps1.2.6.1.4 "><p id="zh-cn_topic_0240188735_p2994161514196"><a name="zh-cn_topic_0240188735_p2994161514196"></a><a name="zh-cn_topic_0240188735_p2994161514196"></a>-</p>
</td>
<td class="cellrowborder" valign="top" width="58.284171582841715%" headers="mcps1.2.6.1.5 "><p id="zh-cn_topic_0240188735_p82551633105614"><a name="zh-cn_topic_0240188735_p82551633105614"></a><a name="zh-cn_topic_0240188735_p82551633105614"></a><span id="ph244511481409"><a name="ph244511481409"></a><a name="ph244511481409"></a>AMCT</span>训练后量化的简易量化配置。</p>
</td>
</tr>
<tr id="zh-cn_topic_0240188735_row9255123311566"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p11249539520"><a name="p11249539520"></a><a name="p11249539520"></a>optional</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p19715115505"><a name="p19715115505"></a><a name="p19715115505"></a>uint32</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="zh-cn_topic_0240188735_p11994171511911"><a name="zh-cn_topic_0240188735_p11994171511911"></a><a name="zh-cn_topic_0240188735_p11994171511911"></a>batch_num</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="zh-cn_topic_0240188735_p32551133175612"><a name="zh-cn_topic_0240188735_p32551133175612"></a><a name="zh-cn_topic_0240188735_p32551133175612"></a>量化使用的batch数量。</p>
</td>
</tr>
<tr id="zh-cn_topic_0240188735_row11255533205611"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p142538635219"><a name="p142538635219"></a><a name="p142538635219"></a>optional</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p13170131414515"><a name="p13170131414515"></a><a name="p13170131414515"></a>bool</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="zh-cn_topic_0240188735_p1225516334564"><a name="zh-cn_topic_0240188735_p1225516334564"></a><a name="zh-cn_topic_0240188735_p1225516334564"></a>activation_offset</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="p2179152617"><a name="p2179152617"></a><a name="p2179152617"></a>数据量化是否带offset。全局配置参数。</p>
<a name="ul1970216412385"></a><a name="ul1970216412385"></a><ul id="ul1970216412385"><li>true：带offset，数据量化时为非对称量化。</li><li>false：不带offset，数据量化时为对称量化。</li></ul>
</td>
</tr>
<tr id="row116751031143112"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p62711337163112"><a name="p62711337163112"></a><a name="p62711337163112"></a>repeated</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p16271153710317"><a name="p16271153710317"></a><a name="p16271153710317"></a>string</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="p1527173716314"><a name="p1527173716314"></a><a name="p1527173716314"></a>skip_layers</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="p6272113718317"><a name="p6272113718317"></a><a name="p6272113718317"></a>不需要量化层的层名。</p>
</td>
</tr>
<tr id="row344417284313"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p1272173743111"><a name="p1272173743111"></a><a name="p1272173743111"></a>repeated</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p17272193713114"><a name="p17272193713114"></a><a name="p17272193713114"></a>string</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="p2272123719311"><a name="p2272123719311"></a><a name="p2272123719311"></a>skip_layer_types</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="p627293783116"><a name="p627293783116"></a><a name="p627293783116"></a>不需要量化的层类型。</p>
</td>
</tr>
<tr id="row13308202915811"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p143081329145819"><a name="p143081329145819"></a><a name="p143081329145819"></a>optional</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p153081529135813"><a name="p153081529135813"></a><a name="p153081529135813"></a>FakequantPrecisionMode</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="p930816292588"><a name="p930816292588"></a><a name="p930816292588"></a>fakequant_precision_mode</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="p1254210571348"><a name="p1254210571348"></a><a name="p1254210571348"></a>fakequant模型中quant自定义算子的scale_d数值精度模式。</p>
<a name="ul3401310203217"></a><a name="ul3401310203217"></a><ul id="ul3401310203217"><li>FORCE_FP16_QUANT：scale_d参数的数值转换为float16精度，数值类型是float32。</li><li>空，即不配置，默认为空。scale_d参数的数值保持float32精度。</li></ul>
</td>
</tr>
<tr id="row1422161319377"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p6422191320375"><a name="p6422191320375"></a><a name="p6422191320375"></a>optional</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p134239134371"><a name="p134239134371"></a><a name="p134239134371"></a>CalibrationConfig</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="p74231313103710"><a name="p74231313103710"></a><a name="p74231313103710"></a>common_config</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="p2797259134011"><a name="p2797259134011"></a><a name="p2797259134011"></a>通用的量化配置，全局量化配置参数。若某层未被override_layer_types或者override_layer_configs重写，则使用该配置。</p>
<p id="p31455545543"><a name="p31455545543"></a><a name="p31455545543"></a>参数优先级：override_layer_configs&gt;override_layer_types&gt;common_config</p>
</td>
</tr>
<tr id="row198411100379"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p10841410123712"><a name="p10841410123712"></a><a name="p10841410123712"></a>repeated</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p1841151033713"><a name="p1841151033713"></a><a name="p1841151033713"></a>OverrideLayerType</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="p6841191033712"><a name="p6841191033712"></a><a name="p6841191033712"></a>override_layer_types</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="p979765994018"><a name="p979765994018"></a><a name="p979765994018"></a>重写某一类型层的量化配置，即对哪些层进行差异化量化。</p>
<p id="p2853153415116"><a name="p2853153415116"></a><a name="p2853153415116"></a>例如全局量化配置参数配置的量化因子搜索步长为0.01，可以通过该参数对部分层进行差异化量化，可以配置搜索步长为0.02。</p>
<p id="p61370245613"><a name="p61370245613"></a><a name="p61370245613"></a>参数优先级：override_layer_configs&gt;override_layer_types&gt;common_config</p>
</td>
</tr>
<tr id="row73596813715"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p163597863717"><a name="p163597863717"></a><a name="p163597863717"></a>repeated</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p1535910814376"><a name="p1535910814376"></a><a name="p1535910814376"></a>OverrideLayer</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="p83598815375"><a name="p83598815375"></a><a name="p83598815375"></a>override_layer_configs</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="p15798105944016"><a name="p15798105944016"></a><a name="p15798105944016"></a>重写某一层的量化配置，即对哪些层进行差异化量化。</p>
<p id="p4394114710214"><a name="p4394114710214"></a><a name="p4394114710214"></a>例如全局量化配置参数配置的量化因子搜索步长为0.01，可以通过该参数对部分层进行差异化量化，可以配置搜索步长为0.02。</p>
<p id="p194543485613"><a name="p194543485613"></a><a name="p194543485613"></a>参数优先级：override_layer_configs&gt;override_layer_types&gt;common_config</p>
</td>
</tr>
<tr id="row145071332133914"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p350814326395"><a name="p350814326395"></a><a name="p350814326395"></a>optional</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p1650819327397"><a name="p1650819327397"></a><a name="p1650819327397"></a>bool</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="p9508193293911"><a name="p9508193293911"></a><a name="p9508193293911"></a>do_fusion</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="p07981859114018"><a name="p07981859114018"></a><a name="p07981859114018"></a>是否开启BN融合功能，默认为true，表示开启该功能。</p>
</td>
</tr>
<tr id="row12466115143717"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p84661857373"><a name="p84661857373"></a><a name="p84661857373"></a>repeated</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p946614503717"><a name="p946614503717"></a><a name="p946614503717"></a>string</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="p1746645143715"><a name="p1746645143715"></a><a name="p1746645143715"></a>skip_fusion_layers</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="p1679819590407"><a name="p1679819590407"></a><a name="p1679819590407"></a>跳过BN融合的层，配置之后这些层不会进行BN融合。</p>
</td>
</tr>
<tr id="row3932455380"><td class="cellrowborder" rowspan="3" valign="top" width="11.148885111488852%" headers="mcps1.2.6.1.1 "><p id="p47611242191418"><a name="p47611242191418"></a><a name="p47611242191418"></a>OverrideLayerType</p>
</td>
<td class="cellrowborder" valign="top" width="6.52934706529347%" headers="mcps1.2.6.1.2 "><p id="p1581853203818"><a name="p1581853203818"></a><a name="p1581853203818"></a>-</p>
</td>
<td class="cellrowborder" valign="top" width="11.188881111888811%" headers="mcps1.2.6.1.3 "><p id="p78053163810"><a name="p78053163810"></a><a name="p78053163810"></a>-</p>
</td>
<td class="cellrowborder" valign="top" width="12.84871512848715%" headers="mcps1.2.6.1.4 "><p id="p10885315383"><a name="p10885315383"></a><a name="p10885315383"></a>-</p>
</td>
<td class="cellrowborder" valign="top" width="58.284171582841715%" headers="mcps1.2.6.1.5 "><p id="p6909137153812"><a name="p6909137153812"></a><a name="p6909137153812"></a>重置某层类型的量化配置。</p>
</td>
</tr>
<tr id="row17134635121413"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p1476234213141"><a name="p1476234213141"></a><a name="p1476234213141"></a>required</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p37627428149"><a name="p37627428149"></a><a name="p37627428149"></a>string</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="p6762342121414"><a name="p6762342121414"></a><a name="p6762342121414"></a>layer_type</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="p07621142171414"><a name="p07621142171414"></a><a name="p07621142171414"></a>支持量化的层类型的名字。</p>
</td>
</tr>
<tr id="row1029523261414"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p776213421145"><a name="p776213421145"></a><a name="p776213421145"></a>required</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p0762174210140"><a name="p0762174210140"></a><a name="p0762174210140"></a>CalibrationConfig</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="p876212426146"><a name="p876212426146"></a><a name="p876212426146"></a>calibration_config</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="p19762942161410"><a name="p19762942161410"></a><a name="p19762942161410"></a>重置的量化配置。</p>
</td>
</tr>
<tr id="zh-cn_topic_0240188735_row11783104092012"><td class="cellrowborder" rowspan="3" valign="top" width="11.148885111488852%" headers="mcps1.2.6.1.1 "><p id="zh-cn_topic_0240188735_p16795192442119"><a name="zh-cn_topic_0240188735_p16795192442119"></a><a name="zh-cn_topic_0240188735_p16795192442119"></a>OverrideLayer</p>
</td>
<td class="cellrowborder" valign="top" width="6.52934706529347%" headers="mcps1.2.6.1.2 "><p id="p9485142585010"><a name="p9485142585010"></a><a name="p9485142585010"></a>-</p>
</td>
<td class="cellrowborder" valign="top" width="11.188881111888811%" headers="mcps1.2.6.1.3 "><p id="p15182214175118"><a name="p15182214175118"></a><a name="p15182214175118"></a>-</p>
</td>
<td class="cellrowborder" valign="top" width="12.84871512848715%" headers="mcps1.2.6.1.4 "><p id="zh-cn_topic_0240188735_p37831240102014"><a name="zh-cn_topic_0240188735_p37831240102014"></a><a name="zh-cn_topic_0240188735_p37831240102014"></a>-</p>
</td>
<td class="cellrowborder" valign="top" width="58.284171582841715%" headers="mcps1.2.6.1.5 "><p id="zh-cn_topic_0240188735_p278314406207"><a name="zh-cn_topic_0240188735_p278314406207"></a><a name="zh-cn_topic_0240188735_p278314406207"></a>重置某层量化配置。</p>
</td>
</tr>
<tr id="zh-cn_topic_0240188735_row10956202614283"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p19444416194419"><a name="p19444416194419"></a><a name="p19444416194419"></a>required</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p1244491612447"><a name="p1244491612447"></a><a name="p1244491612447"></a>string</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="zh-cn_topic_0240188735_p6956152632810"><a name="zh-cn_topic_0240188735_p6956152632810"></a><a name="zh-cn_topic_0240188735_p6956152632810"></a>layer_name</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="zh-cn_topic_0240188735_p1195652613284"><a name="zh-cn_topic_0240188735_p1195652613284"></a><a name="zh-cn_topic_0240188735_p1195652613284"></a>被重置层的层名。</p>
</td>
</tr>
<tr id="zh-cn_topic_0240188735_row1438216329281"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p576421834412"><a name="p576421834412"></a><a name="p576421834412"></a>required</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p1933192654411"><a name="p1933192654411"></a><a name="p1933192654411"></a>CalibrationConfig</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="zh-cn_topic_0240188735_p163821323286"><a name="zh-cn_topic_0240188735_p163821323286"></a><a name="zh-cn_topic_0240188735_p163821323286"></a>calibration_config</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="zh-cn_topic_0240188735_p382913237299"><a name="zh-cn_topic_0240188735_p382913237299"></a><a name="zh-cn_topic_0240188735_p382913237299"></a>重置的量化配置。</p>
</td>
</tr>
<tr id="zh-cn_topic_0240188735_row166322283234"><td class="cellrowborder" rowspan="6" valign="top" width="11.148885111488852%" headers="mcps1.2.6.1.1 "><p id="zh-cn_topic_0240188735_p9633152814236"><a name="zh-cn_topic_0240188735_p9633152814236"></a><a name="zh-cn_topic_0240188735_p9633152814236"></a>CalibrationConfig</p>
<p id="p3120433162119"><a name="p3120433162119"></a><a name="p3120433162119"></a></p>
</td>
<td class="cellrowborder" valign="top" width="6.52934706529347%" headers="mcps1.2.6.1.2 "><p id="p134858254503"><a name="p134858254503"></a><a name="p134858254503"></a>-</p>
</td>
<td class="cellrowborder" valign="top" width="11.188881111888811%" headers="mcps1.2.6.1.3 "><p id="p1818261455119"><a name="p1818261455119"></a><a name="p1818261455119"></a>-</p>
</td>
<td class="cellrowborder" valign="top" width="12.84871512848715%" headers="mcps1.2.6.1.4 "><p id="zh-cn_topic_0240188735_p1363332811232"><a name="zh-cn_topic_0240188735_p1363332811232"></a><a name="zh-cn_topic_0240188735_p1363332811232"></a>-</p>
</td>
<td class="cellrowborder" valign="top" width="58.284171582841715%" headers="mcps1.2.6.1.5 "><p id="zh-cn_topic_0240188735_p363392862320"><a name="zh-cn_topic_0240188735_p363392862320"></a><a name="zh-cn_topic_0240188735_p363392862320"></a>Calibration量化的配置。</p>
</td>
</tr>
<tr id="zh-cn_topic_0240188735_row116226814307"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p1748519253502"><a name="p1748519253502"></a><a name="p1748519253502"></a>-</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p14182171417513"><a name="p14182171417513"></a><a name="p14182171417513"></a>ARQuantize</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="p3275172510116"><a name="p3275172510116"></a><a name="p3275172510116"></a>arq_quantize</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="zh-cn_topic_0240188735_p1962317813010"><a name="zh-cn_topic_0240188735_p1962317813010"></a><a name="zh-cn_topic_0240188735_p1962317813010"></a>权重量化算法配置。</p>
<p id="p245615017124"><a name="p245615017124"></a><a name="p245615017124"></a>arq_quantize：ARQ量化算法配置。</p>
</td>
</tr>
<tr id="row53671411153315"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p12367151111339"><a name="p12367151111339"></a><a name="p12367151111339"></a>-</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p9367811163310"><a name="p9367811163310"></a><a name="p9367811163310"></a>ADAquantize</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="p136714114339"><a name="p136714114339"></a><a name="p136714114339"></a>ada_quantize</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="p53671011193318"><a name="p53671011193318"></a><a name="p53671011193318"></a>权重量化算法配置。</p>
<p id="p3778153020331"><a name="p3778153020331"></a><a name="p3778153020331"></a>ada_quantize：Adaptive rounding (AdaRound) ，自适应舍入量化算法配置。</p>
</td>
</tr>
<tr id="zh-cn_topic_0240188735_row9881174683115"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p1548512525015"><a name="p1548512525015"></a><a name="p1548512525015"></a>-</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p1183191465111"><a name="p1183191465111"></a><a name="p1183191465111"></a>FMRQuantize</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="p425415411015"><a name="p425415411015"></a><a name="p425415411015"></a>ifmr_quantize</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="zh-cn_topic_0240188735_p1788134616316"><a name="zh-cn_topic_0240188735_p1788134616316"></a><a name="zh-cn_topic_0240188735_p1788134616316"></a>数据量化算法配置。</p>
<p id="zh-cn_topic_0240188735_p186119548317"><a name="zh-cn_topic_0240188735_p186119548317"></a><a name="zh-cn_topic_0240188735_p186119548317"></a>ifmr_quantize：IFMR量化算法配置。</p>
</td>
</tr>
<tr id="row784910920348"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p123369144483"><a name="p123369144483"></a><a name="p123369144483"></a>-</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p1233691404813"><a name="p1233691404813"></a><a name="p1233691404813"></a>HFMGQuantize</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="p1833601494810"><a name="p1833601494810"></a><a name="p1833601494810"></a>hfmg_quantize</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="p13337191454814"><a name="p13337191454814"></a><a name="p13337191454814"></a>数据量化算法配置。</p>
<p id="p8424174634818"><a name="p8424174634818"></a><a name="p8424174634818"></a>hfmg_quantize：HFMG量化算法配置。</p>
</td>
</tr>
<tr id="row1312073315215"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p21209331216"><a name="p21209331216"></a><a name="p21209331216"></a>-</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p16120183319212"><a name="p16120183319212"></a><a name="p16120183319212"></a>DMQBalancer</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="p21202332217"><a name="p21202332217"></a><a name="p21202332217"></a>dmq_balancer</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="p1953551824417"><a name="p1953551824417"></a><a name="p1953551824417"></a>均衡量化算法配置。</p>
<p id="p12535171816448"><a name="p12535171816448"></a><a name="p12535171816448"></a>dmq_balancer：DMQBalancer均衡算法配置。</p>
</td>
</tr>
<tr id="zh-cn_topic_0240188735_row13931454162310"><td class="cellrowborder" rowspan="3" valign="top" width="11.148885111488852%" headers="mcps1.2.6.1.1 "><p id="zh-cn_topic_0240188735_p133932548230"><a name="zh-cn_topic_0240188735_p133932548230"></a><a name="zh-cn_topic_0240188735_p133932548230"></a>ARQuantize</p>
</td>
<td class="cellrowborder" valign="top" width="6.52934706529347%" headers="mcps1.2.6.1.2 "><p id="p2485725185011"><a name="p2485725185011"></a><a name="p2485725185011"></a>-</p>
</td>
<td class="cellrowborder" valign="top" width="11.188881111888811%" headers="mcps1.2.6.1.3 "><p id="p91831214185113"><a name="p91831214185113"></a><a name="p91831214185113"></a>-</p>
</td>
<td class="cellrowborder" valign="top" width="12.84871512848715%" headers="mcps1.2.6.1.4 "><p id="zh-cn_topic_0240188735_p16393454142316"><a name="zh-cn_topic_0240188735_p16393454142316"></a><a name="zh-cn_topic_0240188735_p16393454142316"></a>-</p>
</td>
<td class="cellrowborder" valign="top" width="58.284171582841715%" headers="mcps1.2.6.1.5 "><p id="zh-cn_topic_0240188735_p7393554192316"><a name="zh-cn_topic_0240188735_p7393554192316"></a><a name="zh-cn_topic_0240188735_p7393554192316"></a>ARQ量化算法配置。算法介绍请参见<a href="../算法介绍.md">ARQ权重量化算法</a>。</p>
<p id="p817613334379"><a name="p817613334379"></a><a name="p817613334379"></a>该算法与ADAquantize、NUQuantize算法不能同时配置，若同时配置，则以配置文件中最后配置的量化算法为准。</p>
</td>
</tr>
<tr id="zh-cn_topic_0240188735_row73046209318"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p169601842123113"><a name="p169601842123113"></a><a name="p169601842123113"></a>optional</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p0183111410516"><a name="p0183111410516"></a><a name="p0183111410516"></a>bool</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="zh-cn_topic_0240188735_p143040207319"><a name="zh-cn_topic_0240188735_p143040207319"></a><a name="zh-cn_topic_0240188735_p143040207319"></a>channel_wise</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="zh-cn_topic_0240188735_p3304220153114"><a name="zh-cn_topic_0240188735_p3304220153114"></a><a name="zh-cn_topic_0240188735_p3304220153114"></a>是否对每个channel采用不同的量化因子。</p>
<a name="zh-cn_topic_0240188002_ul1212114910429"></a><a name="zh-cn_topic_0240188002_ul1212114910429"></a><ul id="zh-cn_topic_0240188002_ul1212114910429"><li>true：每个channel独立量化，量化因子不同。</li><li>false：所有channel同时量化，共享量化因子。</li></ul>
</td>
</tr>
<tr id="row0592142212598"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p1259332216599"><a name="p1259332216599"></a><a name="p1259332216599"></a>optional</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p3593162219599"><a name="p3593162219599"></a><a name="p3593162219599"></a>uint32</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="p155931422185911"><a name="p155931422185911"></a><a name="p155931422185911"></a>quant_bits</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="p138471244328"><a name="p138471244328"></a><a name="p138471244328"></a>权重量化位宽。支持配置为INT6、INT7、INT8。</p>
<p id="p1593202215913"><a name="p1593202215913"></a><a name="p1593202215913"></a>默认为INT8量化。</p>
<p id="p26777718459"><a name="p26777718459"></a><a name="p26777718459"></a>该字段配置为INT6、INT7仅支持Conv2d类型算子。</p>
<p id="p894111615316"><a name="p894111615316"></a><a name="p894111615316"></a>如果在common_config中配置quant_bits为INT6、INT7，则只对Conv2d算子生效，其他算子改为默认INT8。</p>
</td>
</tr>
<tr id="row27761940115319"><td class="cellrowborder" rowspan="7" valign="top" width="11.148885111488852%" headers="mcps1.2.6.1.1 "><p id="p87761040195315"><a name="p87761040195315"></a><a name="p87761040195315"></a>ADAquantize</p>
</td>
<td class="cellrowborder" valign="top" width="6.52934706529347%" headers="mcps1.2.6.1.2 "><p id="p14776134014536"><a name="p14776134014536"></a><a name="p14776134014536"></a>-</p>
</td>
<td class="cellrowborder" valign="top" width="11.188881111888811%" headers="mcps1.2.6.1.3 "><p id="p137771540125314"><a name="p137771540125314"></a><a name="p137771540125314"></a>-</p>
</td>
<td class="cellrowborder" valign="top" width="12.84871512848715%" headers="mcps1.2.6.1.4 "><p id="p9777144010535"><a name="p9777144010535"></a><a name="p9777144010535"></a>-</p>
</td>
<td class="cellrowborder" valign="top" width="58.284171582841715%" headers="mcps1.2.6.1.5 "><p id="p91642185612"><a name="p91642185612"></a><a name="p91642185612"></a>AdaRound自适应舍入量化算法，算法介绍请参见<a href="../算法介绍.md">ADA权重量化算法</a>。</p>
<p id="p0329794386"><a name="p0329794386"></a><a name="p0329794386"></a>该算法与ARQuantize、NUQuantize算法不能同时配置，若同时配置，则以配置文件中最后配置的量化算法为准。</p>
<p id="p9965162019211"><a name="p9965162019211"></a><a name="p9965162019211"></a>该量化算法支持的激活函数为：ReLU、RReLU、LeakyReLU、PReLU、GELU、ReLU6、Sigmoid、Tanh。</p>
<p id="p154861059165910"><a name="p154861059165910"></a><a name="p154861059165910"></a>上述激活函数对应的ONNX算子为：Relu、LeakyRelu、LeakyRelu、PRelu、Gelu、Clip、Sigmoid、Tanh。</p>
<p id="p156871018154716"><a name="p156871018154716"></a><a name="p156871018154716"></a><span id="ph284172920174"><a name="ph284172920174"></a><a name="ph284172920174"></a>AMCT</span>工具获取量化配置中的可量化层（该特性支持的量化层为torch.nn.Linear、torch.nn.Conv2d、torch.nn.ConvTranspose2d），按照导出的ONNX模型中的拓扑顺序获取可量化模块，若量化模块后为上述激活函数，将量化模块和激活函数作为一个整体。</p>
<p id="p1785318562586"><a name="p1785318562586"></a><a name="p1785318562586"></a>说明：</p>
<p id="p4162741185615"><a name="p4162741185615"></a><a name="p4162741185615"></a>将上述激活函数导出为ONNX算子时，需要torch 2.1版本torch.onnx.export接口，且Gelu算子需要Opset版本为v20，其他算子Opset版本为v17。</p>
</td>
</tr>
<tr id="row157031336145319"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p7704936155313"><a name="p7704936155313"></a><a name="p7704936155313"></a>optional</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p8704103614536"><a name="p8704103614536"></a><a name="p8704103614536"></a>uint32</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="p15704163655316"><a name="p15704163655316"></a><a name="p15704163655316"></a>num_iteration</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="p107041636145318"><a name="p107041636145318"></a><a name="p107041636145318"></a>迭代次数，取值范围&gt;=0，默认值为10000。</p>
</td>
</tr>
<tr id="row189587384530"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p16959538165310"><a name="p16959538165310"></a><a name="p16959538165310"></a>optional</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p980283165517"><a name="p980283165517"></a><a name="p980283165517"></a>float</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="p89591638175318"><a name="p89591638175318"></a><a name="p89591638175318"></a>reg_param</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="p195903825318"><a name="p195903825318"></a><a name="p195903825318"></a><span>正则化参数</span>，取值范围为(0,1)，默认值为0.01。</p>
</td>
</tr>
<tr id="row1979535105311"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p47963505311"><a name="p47963505311"></a><a name="p47963505311"></a>optional</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p28101031145517"><a name="p28101031145517"></a><a name="p28101031145517"></a>float</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="p17915350536"><a name="p17915350536"></a><a name="p17915350536"></a>beta_range_start</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="p82744544620"><a name="p82744544620"></a><a name="p82744544620"></a>beta起始参数，默认值为20，beta_range_start&gt;beta_range_end&gt;0。</p>
</td>
</tr>
<tr id="row094213125310"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p1594353112535"><a name="p1594353112535"></a><a name="p1594353112535"></a>optional</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p13816831125514"><a name="p13816831125514"></a><a name="p13816831125514"></a>float</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="p1794319317539"><a name="p1794319317539"></a><a name="p1794319317539"></a>beta_range_end</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="p1726314151973"><a name="p1726314151973"></a><a name="p1726314151973"></a>beta终止参数，默认值为2。</p>
</td>
</tr>
<tr id="row18298122915546"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p1529892955410"><a name="p1529892955410"></a><a name="p1529892955410"></a>optional</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p1082210311552"><a name="p1082210311552"></a><a name="p1082210311552"></a>float</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="p1829912975414"><a name="p1829912975414"></a><a name="p1829912975414"></a>warm_start</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="p820812511358"><a name="p820812511358"></a><a name="p820812511358"></a>预热因子，取值范围为(0,1)，默认值为0.2。</p>
</td>
</tr>
<tr id="row129538314542"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p179538312543"><a name="p179538312543"></a><a name="p179538312543"></a>optional</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p11954131165420"><a name="p11954131165420"></a><a name="p11954131165420"></a>bool</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="p1895483111547"><a name="p1895483111547"></a><a name="p1895483111547"></a>channel_wise</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="p14805169105713"><a name="p14805169105713"></a><a name="p14805169105713"></a>是否对每个channel采用不同的量化因子。</p>
<a name="ul680517915571"></a><a name="ul680517915571"></a><ul id="ul680517915571"><li>true：每个channel独立量化，量化因子不同。</li><li>false：所有channel同时量化，共享量化因子。</li></ul>
</td>
</tr>
<tr id="row14121356145210"><td class="cellrowborder" rowspan="2" valign="top" width="11.148885111488852%" headers="mcps1.2.6.1.1 "><p id="p983618745316"><a name="p983618745316"></a><a name="p983618745316"></a>DMQBalancer</p>
</td>
<td class="cellrowborder" valign="top" width="6.52934706529347%" headers="mcps1.2.6.1.2 "><p id="p1383615745310"><a name="p1383615745310"></a><a name="p1383615745310"></a>-</p>
</td>
<td class="cellrowborder" valign="top" width="11.188881111888811%" headers="mcps1.2.6.1.3 "><p id="p19836072536"><a name="p19836072536"></a><a name="p19836072536"></a>-</p>
</td>
<td class="cellrowborder" valign="top" width="12.84871512848715%" headers="mcps1.2.6.1.4 "><p id="p108368785317"><a name="p108368785317"></a><a name="p108368785317"></a>-</p>
</td>
<td class="cellrowborder" valign="top" width="58.284171582841715%" headers="mcps1.2.6.1.5 "><p id="p14836137155316"><a name="p14836137155316"></a><a name="p14836137155316"></a>DMQ均衡算法配置。算法介绍请参见<a href="../算法介绍.md">DMQ均衡算法</a>。</p>
</td>
</tr>
<tr id="row579116575524"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p12836177175313"><a name="p12836177175313"></a><a name="p12836177175313"></a>optional</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p783619725310"><a name="p783619725310"></a><a name="p783619725310"></a>float</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="p8837127185313"><a name="p8837127185313"></a><a name="p8837127185313"></a>migration_strength</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="p128373710530"><a name="p128373710530"></a><a name="p128373710530"></a>迁移强度，代表将activation数据上的量化难度迁移至weight权重的程度。支持的范围为[0.2, 0.8]，默认值0.5，数据分布的离群值越大迁移强度应设置较小。</p>
</td>
</tr>
<tr id="zh-cn_topic_0240188735_row188464215242"><td class="cellrowborder" rowspan="8" valign="top" width="11.148885111488852%" headers="mcps1.2.6.1.1 "><p id="zh-cn_topic_0240188735_p784622112414"><a name="zh-cn_topic_0240188735_p784622112414"></a><a name="zh-cn_topic_0240188735_p784622112414"></a>FMRQuantize</p>
</td>
<td class="cellrowborder" valign="top" width="6.52934706529347%" headers="mcps1.2.6.1.2 "><p id="p144853253508"><a name="p144853253508"></a><a name="p144853253508"></a>-</p>
</td>
<td class="cellrowborder" valign="top" width="11.188881111888811%" headers="mcps1.2.6.1.3 "><p id="p918371455114"><a name="p918371455114"></a><a name="p918371455114"></a>-</p>
</td>
<td class="cellrowborder" valign="top" width="12.84871512848715%" headers="mcps1.2.6.1.4 "><p id="zh-cn_topic_0240188735_p1984611242417"><a name="zh-cn_topic_0240188735_p1984611242417"></a><a name="zh-cn_topic_0240188735_p1984611242417"></a>-</p>
</td>
<td class="cellrowborder" valign="top" width="58.284171582841715%" headers="mcps1.2.6.1.5 "><p id="zh-cn_topic_0240188735_p58460292417"><a name="zh-cn_topic_0240188735_p58460292417"></a><a name="zh-cn_topic_0240188735_p58460292417"></a>FMR数据量化算法配置。算法介绍请参见<a href="../算法介绍.md">IFMR数据量化算法</a>。</p>
<p id="p1877244707"><a name="p1877244707"></a><a name="p1877244707"></a>该算法与HFMGQuantize算法不能同时配置，若同时配置，则以配置文件中最后配置的量化算法为准。</p>
</td>
</tr>
<tr id="zh-cn_topic_0240188735_row8300152716336"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p129891923173117"><a name="p129891923173117"></a><a name="p129891923173117"></a>optional</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p3183111418515"><a name="p3183111418515"></a><a name="p3183111418515"></a>float</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="zh-cn_topic_0240188735_p20300132763310"><a name="zh-cn_topic_0240188735_p20300132763310"></a><a name="zh-cn_topic_0240188735_p20300132763310"></a>search_range_start</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="zh-cn_topic_0240188735_p11300627183317"><a name="zh-cn_topic_0240188735_p11300627183317"></a><a name="zh-cn_topic_0240188735_p11300627183317"></a>量化因子搜索范围左边界。</p>
</td>
</tr>
<tr id="zh-cn_topic_0240188735_row1918914326335"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p182317254611"><a name="p182317254611"></a><a name="p182317254611"></a>optional</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p118237212462"><a name="p118237212462"></a><a name="p118237212462"></a>float</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="zh-cn_topic_0240188735_p3189232123318"><a name="zh-cn_topic_0240188735_p3189232123318"></a><a name="zh-cn_topic_0240188735_p3189232123318"></a>search_range_end</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="zh-cn_topic_0240188735_p1954495473717"><a name="zh-cn_topic_0240188735_p1954495473717"></a><a name="zh-cn_topic_0240188735_p1954495473717"></a>量化因子搜索范围右边界。</p>
</td>
</tr>
<tr id="zh-cn_topic_0240188735_row20464636113312"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p1861918118479"><a name="p1861918118479"></a><a name="p1861918118479"></a>optional</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p1461910118476"><a name="p1461910118476"></a><a name="p1461910118476"></a>float</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="zh-cn_topic_0240188735_p13464113615338"><a name="zh-cn_topic_0240188735_p13464113615338"></a><a name="zh-cn_topic_0240188735_p13464113615338"></a>search_step</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="zh-cn_topic_0240188735_p104647369332"><a name="zh-cn_topic_0240188735_p104647369332"></a><a name="zh-cn_topic_0240188735_p104647369332"></a>量化因子搜索步长。</p>
</td>
</tr>
<tr id="zh-cn_topic_0240188735_row1710933263612"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p1861412254714"><a name="p1861412254714"></a><a name="p1861412254714"></a>optional</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p061418264717"><a name="p061418264717"></a><a name="p061418264717"></a>float</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="zh-cn_topic_0240188735_p1810983233616"><a name="zh-cn_topic_0240188735_p1810983233616"></a><a name="zh-cn_topic_0240188735_p1810983233616"></a>max_percentile</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="zh-cn_topic_0240188735_p161093322365"><a name="zh-cn_topic_0240188735_p161093322365"></a><a name="zh-cn_topic_0240188735_p161093322365"></a>最大值搜索位置。</p>
</td>
</tr>
<tr id="zh-cn_topic_0240188735_row26036420362"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p1075110319475"><a name="p1075110319475"></a><a name="p1075110319475"></a>optional</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p117511331479"><a name="p117511331479"></a><a name="p117511331479"></a>float</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="zh-cn_topic_0240188735_p1060420421361"><a name="zh-cn_topic_0240188735_p1060420421361"></a><a name="zh-cn_topic_0240188735_p1060420421361"></a>min_percentile</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="zh-cn_topic_0240188735_p186041242183616"><a name="zh-cn_topic_0240188735_p186041242183616"></a><a name="zh-cn_topic_0240188735_p186041242183616"></a>最小值搜索位置。</p>
</td>
</tr>
<tr id="row156362201313"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p2876102645420"><a name="p2876102645420"></a><a name="p2876102645420"></a>optional</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p16876102655416"><a name="p16876102655416"></a><a name="p16876102655416"></a>bool</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="p136291318105419"><a name="p136291318105419"></a><a name="p136291318105419"></a>asymmetric</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="p18570132515213"><a name="p18570132515213"></a><a name="p18570132515213"></a>是否进行对称量化。用于控制逐层量化算法的选择。</p>
<a name="ul78601245115510"></a><a name="ul78601245115510"></a><ul id="ul78601245115510"><li>true：非对称量化</li><li>false：对称量化</li></ul>
<p id="p1784404618555"><a name="p1784404618555"></a><a name="p1784404618555"></a>如果override_layer_configs、override_layer_types、common_config配置项都配置该参数，或者配置了</p>
<p id="p58430467557"><a name="p58430467557"></a><a name="p58430467557"></a>activation_offset参数，则生效优先级为：</p>
<p id="p1630711108390"><a name="p1630711108390"></a><a name="p1630711108390"></a>override_layer_configs&gt;override_layer_types&gt;common_config&gt;activation_offset</p>
</td>
</tr>
<tr id="row65481912144710"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p15647105044715"><a name="p15647105044715"></a><a name="p15647105044715"></a>optional</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p12647350104719"><a name="p12647350104719"></a><a name="p12647350104719"></a>CalibrationDataType</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="p1764710503474"><a name="p1764710503474"></a><a name="p1764710503474"></a>dst_type</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="p164710507471"><a name="p164710507471"></a><a name="p164710507471"></a>量化位宽，数据量化是采用INT8量化还是INT16量化，默认为INT8量化。<strong id="b7442433134911"><a name="b7442433134911"></a><a name="b7442433134911"></a>当前版本仅支持INT8量化。</strong></p>
</td>
</tr>
<tr id="row11961131163419"><td class="cellrowborder" rowspan="4" valign="top" width="11.148885111488852%" headers="mcps1.2.6.1.1 "><p id="p18771725134917"><a name="p18771725134917"></a><a name="p18771725134917"></a>HFMGQuantize</p>
</td>
<td class="cellrowborder" valign="top" width="6.52934706529347%" headers="mcps1.2.6.1.2 "><p id="p56910313515"><a name="p56910313515"></a><a name="p56910313515"></a>-</p>
</td>
<td class="cellrowborder" valign="top" width="11.188881111888811%" headers="mcps1.2.6.1.3 "><p id="p146916335113"><a name="p146916335113"></a><a name="p146916335113"></a>-</p>
</td>
<td class="cellrowborder" valign="top" width="12.84871512848715%" headers="mcps1.2.6.1.4 "><p id="p196910310511"><a name="p196910310511"></a><a name="p196910310511"></a>-</p>
</td>
<td class="cellrowborder" valign="top" width="58.284171582841715%" headers="mcps1.2.6.1.5 "><p id="p16989132195213"><a name="p16989132195213"></a><a name="p16989132195213"></a>HFMG数据量化算法配置。算法介绍请参见<a href="../算法介绍.md">HFMG数据量化算法</a>。</p>
<p id="p0610538149"><a name="p0610538149"></a><a name="p0610538149"></a>该算法与FMRQuantize算法不能同时配置，若同时配置，则以配置文件中最后配置的量化算法为准。</p>
</td>
</tr>
<tr id="row177009291348"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p3776259496"><a name="p3776259496"></a><a name="p3776259496"></a>optional</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p1777172594910"><a name="p1777172594910"></a><a name="p1777172594910"></a>uint32</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="p1277122516495"><a name="p1277122516495"></a><a name="p1277122516495"></a>num_of_bins</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="p14190312023"><a name="p14190312023"></a><a name="p14190312023"></a>直方图的bin（直方图中的一个最小单位直方图形）数目，支持的范围为{1024, 2048, 4096, 8192}。</p>
<p id="p1772259498"><a name="p1772259498"></a><a name="p1772259498"></a>默认值为4096。</p>
</td>
</tr>
<tr id="row1187284116114"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p1759374312114"><a name="p1759374312114"></a><a name="p1759374312114"></a>optional</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p10593144314119"><a name="p10593144314119"></a><a name="p10593144314119"></a>bool</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="p359316431317"><a name="p359316431317"></a><a name="p359316431317"></a>asymmetric</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="p1240373012612"><a name="p1240373012612"></a><a name="p1240373012612"></a>是否进行对称量化。用于控制逐层量化算法的选择。</p>
<a name="ul812310517497"></a><a name="ul812310517497"></a><ul id="ul812310517497"><li>true：非对称量化</li><li>false：对称量化</li></ul>
<p id="p64035306619"><a name="p64035306619"></a><a name="p64035306619"></a>如果override_layer_configs、override_layer_types、common_config配置项都配置该参数，或者配置了</p>
<p id="p10403430769"><a name="p10403430769"></a><a name="p10403430769"></a>activation_offset参数，则生效优先级为：</p>
<p id="p8403163010613"><a name="p8403163010613"></a><a name="p8403163010613"></a>override_layer_configs&gt;override_layer_types&gt;common_config&gt;activation_offset</p>
</td>
</tr>
<tr id="row131961176472"><td class="cellrowborder" valign="top" headers="mcps1.2.6.1.1 "><p id="p121262037155118"><a name="p121262037155118"></a><a name="p121262037155118"></a>optional</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.2 "><p id="p812683719512"><a name="p812683719512"></a><a name="p812683719512"></a>CalibrationDataType</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.3 "><p id="p16126537175117"><a name="p16126537175117"></a><a name="p16126537175117"></a>dst_type</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.6.1.4 "><p id="p47171749181715"><a name="p47171749181715"></a><a name="p47171749181715"></a>数据量化位宽，数据量化是采用INT8量化还是INT16量化，默认为INT8量化。<strong id="b1284153614327"><a name="b1284153614327"></a><a name="b1284153614327"></a>当前版本仅支持INT8量化。</strong></p>
</td>
</tr>
</tbody>
</table>


-   基于该文件构造的**训练后量化简易配置文件**_quant_.cfg样例如下所示：

    ```
    # global quantize parameter
    batch_num : 2
    activation_offset : true
    skip_layers : "Opname"
    skip_layer_types:"Optype"
    do_fusion: true
    skip_fusion_layers : "Opname"
    common_config : {
        arq_quantize : {
            channel_wise : true
            quant_bits : 7
        }
        ifmr_quantize : {
            search_range_start : 0.7
            search_range_end : 1.3
            search_step : 0.01
            max_percentile : 0.999999
            min_percentile : 0.999999
            asymmetric : true
        }
         dmq_balancer : {
             migration_strength : 0.5
        }
    }
     
    override_layer_types : {
        layer_type : "Conv2d"
        calibration_config : {
            arq_quantize : {
                channel_wise : false
                quant_bits : 6
            }
            ifmr_quantize : {
                search_range_start : 0.8
                search_range_end : 1.2
                search_step : 0.02
                max_percentile : 0.999999
                min_percentile : 0.999999
                asymmetric : false
            }
             dmq_balancer : {
                  migration_strength : 0.5
             }
        }
    }
     
    override_layer_configs : {
        layer_name : "Opname"
        calibration_config : {
            arq_quantize : {
                channel_wise : true
            }
            ifmr_quantize : {
                search_range_start : 0.8
                search_range_end : 1.2
                search_step : 0.02
                max_percentile : 0.999999
                min_percentile : 0.999999
                 asymmetric : false
            }
             dmq_balancer : {
                  migration_strength : 0.5
             }
        }
    }
    ```

    如果数据量化算法使用HFMG，则上述配置文件中加粗部分可以替换成如下参考参数信息，举例如下（如下配置信息只是样例，请根据实际情况进行修改）：

    ```
    # global quantize parameter
    activation_offset : true
    batch_num : 2
    ...
    common_config : {
        hfmg_quantize : {
            num_of_bins : 4096
             asymmetric : false
        }
    ...
    }
    ```

-   基于该文件构造的**自适应舍入简易配置文件**_ada\_round.cfg_样例如下所示：

    ```
    common_config : {
        ada_quantize : {
            num_iteration : 10000
            warm_start : 0.2
            reg_param : 0.01
            beta_range_start : 20
            beta_range_end : 2
            channel_wise : false
        }
    }
    ```

-   基于该文件构造的**量化数据均衡预处理简易配置文件**_dmq\_balancer_.cfg样例如下所示：

    ```
    # global quantize parameter
    batch_num : 2
    activation_offset : true
    skip_layers : "Opname"
    skip_layer_types:"Optype"
    do_fusion: true
    skip_fusion_layers : "Opname"
    common_config : {
        arq_quantize : {
            channel_wise : true
        }
        ifmr_quantize : {
            search_range_start : 0.7
            search_range_end : 1.3
            search_step : 0.01
            max_percentile : 0.999999
            min_percentile : 0.999999
            asymmetric : true
        }
         dmq_balancer : {
            migration_strength : 0.5
        }
    }
     
    override_layer_types : {
        layer_type : "Optype"
        calibration_config : {
            arq_quantize : {
                channel_wise : false
            }
            ifmr_quantize : {
                search_range_start : 0.8
                search_range_end : 1.2
                search_step : 0.02
                max_percentile : 0.999999
                min_percentile : 0.999999
                asymmetric : false
            }
           dmq_balancer : {
               migration_strength : 0.5
           }
        }
    }
     
    override_layer_configs : {
        layer_name : "Opname"
        calibration_config : {
            arq_quantize : {
                channel_wise : true
            }
            ifmr_quantize : {
                search_range_start : 0.8
                search_range_end : 1.2
                search_step : 0.02
                max_percentile : 0.999999
                min_percentile : 0.999999
                asymmetric : false
            }
           dmq_balancer : {
               migration_strength : 0.5
           }
        }
    }
    ```

